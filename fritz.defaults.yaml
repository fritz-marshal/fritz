skyportal:
  app:
    title: Fritz
    logos: # Logos to place in the top-left of the header bar (zero or more)
      - src: /static/images/GROWTH_logo.png
        alt_text: GROWTH logo
      - src: /static/images/skyportal_logo_dark.png
        alt_text: Skyportal logo

    # This secret key can be any random string of
    # characters.
    #
    # You should re-generate this for your application
    # using:
    #
    # base64.b64encode(os.urandom(50)).decode('ascii')
    secret_key: abc01234
    factory: skyportal.app_server_fritz.make_app_fritz

    heasarc_endpoint: https://heasarc.gsfc.nasa.gov

    # this endpoint does not actually do anything -- it is just for testing
    sedm_endpoint: http://minar.caltech.edu/add_fritz

    lt_host: 161.72.57.3
    lt_port: 8080

    lco_protocol: https
    lco_host: observe.lco.global
    lco_port: 443

    lco_archive_endpoint: https://archive-api.lco.global

    ztf:
      protocol: https
      host: kowalski.caltech.edu
      port: 443

    ztf_forced_endpoint: https://ztfweb.ipac.caltech.edu

    swift:
      protocol: https
      host: www.swift.psu.edu
      port: 443

    swift_xrt_endpoint: https://www.swift.ac.uk/user_objects

    ps1_endpoint: https://catalogs.mast.stsci.edu/

    tess_endpoint: https://tess.mit.edu/public/tesstransients/

    atlas:
      protocol: https
      host: fallingstar-data.com

    kait:
      protocol: http
      host: herculesii.astro.berkeley.edu

    colibri:
      protocol: http
      host:
      port:

    gemini:
      protocol: https
      host: gsodbtest.gemini.edu # this is the test server host, just remove 'test' for production
      port: 8443 # this is the test server port, production is 443

    treasuremap_endpoint: https://treasuremap.space

    tns:
      endpoint: https://sandbox.wis-tns.org
      bot_id:
      bot_name:
      api_key:
      look_back_days: 7

    hermes:
      endpoint: https://hermes.lco.global/api/v0
      topic: hermes.test
      token:

    winter:
      protocol: http
      host: winter.caltech.edu
      port: 82
      submit_trigger: False # if False, the API POST call will only validate the payload

    gracedb_endpoint: https://gracedb.ligo.org/api/

    mpc_endpoint: https://minorplanetcenter.net

    # See https://stackoverflow.com/a/35604855 for syntax
    # These are Javascript component routes
    routes:
      - path: "/"
        component: templates/HomePage
        exact: True
      - path: "/source/:id"
        component: source/Source
      - path: "/favorites"
        component: listing/FavoritesPage
      - path: "/groups"
        component: group/Groups
      - path: "/group/:id"
        component: group/Group
      - path: "/profile"
        component: user/Profile
      - path: "/candidates"
        component: candidate/CandidateList
      - path: "/candidates/scan_reports"
        component: candidate/scan_reports/ReportsList
      - path: "/sources"
        component: source/SourceList
      - path: "/user/:id"
        component: user/UserInfo
      - path: "/upload_photometry/:id"
        component: photometry/UploadPhotometry
      - path: "/about"
        component: About
      - path: "/share_data/:id"
        component: source/ShareDataForm
      - path: "/filter/:fid"
        component: filter/Filter
      - path: "/runs"
        component: observing_run/ObservingRunPage
      - path: "/run/:id"
        component: observing_run/RunSummary
      - path: "/allocations"
        component: allocation/AllocationPage
      - path: "/allocation/:id"
        component: allocation/AllocationSummary
      - path: "/telescope/:id"
        component: telescope/TelescopeSummary
      - path: "/instrument/:id"
        component: instrument/InstrumentSummary
      - path: "/group_sources/:id"
        component: group/GroupSources
      - path: "/user_management"
        component: user/UserManagement
      - path: "/alerts"
        component: alert/Alerts
      - path: "/alerts/ztf/:id"
        component: alert/ZTFAlert
      - path: "/archive"
        component: archive/Archive
      - path: "/upload_spectrum/:id"
        component: spectrum/UploadSpectrum
      - path: "/source/:id/finder"
        component: FindingChart
      - path: "/observability/:id"
        component: source/Observability
      - path: "/source/:id/periodogram"
        component: Periodogram
      - path: "/db_stats"
        component: DBStats
      - path: "/galaxies"
        component: galaxy/GalaxyPage
      - path: "/spatial_catalogs"
        component: spatial_catalog/SpatialCatalogPage
      - path: "/gcn_events"
        component: gcn/GcnEvents
      - path: "/gcn_events/:dateobs"
        component: gcn/GcnEventPage
      - path: "/telescopes"
        component: telescope/TelescopePage
      - path: "/instruments"
        component: instrument/InstrumentPage
      - path: "/mmadetectors"
        component: mma_detector/MMADetectorPage
      - path: "/services"
        component: analysis/AnalysisServicePage
      - path: "/recurring_apis"
        component: RecurringAPIPage
      - path: "/shifts"
        component: shift/ShiftNoId
      - path: "/shifts/:id"
        component: shift/ShiftWithId
      - path: "/summary_search"
        component: summary/SummarySearch
      - path: "/observations"
        component: observation/ObservationPage
      - path: "/followup_requests"
        component: followup_request/FollowupRequestPage
      - path: "/source/:obj_id/analysis/:analysis_id"
        component: source/SourceAnalysisPage
      - path: "/tag_management"
        component: TagManagement
      - path: "/taxonomies"
        component: taxonomy/TaxonomyPage
      - path: "/sharing_services"
        component: sharing_service/SharingServicesPage
      - path: "/sharing_service/:id/submissions"
        component: sharing_service/SharingServiceSubmissionsPage
      - path: "/moving_objects/obsplan"
        component: moving_object/MovingObjectObsPlanPage

    observation_plan:
      default_filters: ['ztfg', 'ztfr', 'ztfi']
      use_skyportal_fields: True

    kowalski:
      protocol: http
      host: kowalski-api-1
      port: 4000
      token:
    # a (dedicated) Kowalski instance holding the ZTF light curve data referred to as Gloria
    gloria:
      protocol: http
      host: kowalski-api-1
      port: 4000
      token:
    melman:
      protocol: http
      host: kowalski-api-1
      port: 4000
      token:

    sidebar:
      # See https://material-ui.com/components/material-icons/
      - name: main
        subitems:
          - name: Dashboard
            icon: Home
            url: /

          - name: Sources
            icon: Storage
            url: /sources

          - name: Candidates
            icon: Search
            url: /candidates

          - name: Favorites
            icon: Star
            url: /favorites

          - name: Alerts
            icon: Explore
            url: /alerts

          - name: Persistent Sources
            icon: CloudCircle
            url: /archive

          - name: Groups
            icon: GroupWork
            url: /groups

          - name: Observing Runs
            icon: LocalCafe
            url: /runs

          - name: GCN Events
            icon: SettingsInputAntenna
            url: /gcn_events

          - name: Followup Requests
            icon: WorkOutlined
            url: /followup_requests

          - name: Shifts
            icon: SubwayRounded
            url: /shifts

          - name: Summary Search
            icon: Troubleshoot
            url: /summary_search

          - name: About
            icon: Info
            url: /about

      - name: Other
        icon: MoreHoriz
        subitems:
          - name: Telescopes
            icon: MyLocation
            url: /telescopes

          - name: Instruments
            icon: Wifi
            url: /instruments

          - name: MMADetectors
            icon: Abc
            url: /mmadetectors

          - name: Allocations
            icon: HourglassEmptyOutlined
            url: /allocations

          - name: Observations
            icon: ZoomInOutlined
            url: /observations

          - name: Scanning report
            icon: Summarize
            url: /candidates/scan_reports

          - name: Sharing Services
            icon: Share
            url: /sharing_services

          - name: Moving Objects
            icon: Animation
            url: /moving_objects/obsplan

          - name: Galaxies
            icon: TornadoOutlined
            url: /galaxies

          - name: Spatial Catalogs
            icon: PhotoSizeSelectLargeOutlined
            url: /spatial_catalogs

          - name: Analysis Services
            icon: SentimentSatisfied
            url: /services

          - name: Recurring API
            icon: Restore
            url: /recurring_apis

          - name: Tag Management
            icon: LocalOffer
            permissions: ["Manage sources", "System admin"]
            url: /tag_management

          - name: Taxonomies
            icon: WallpaperOutlined
            url: /taxonomies

      - name: Admin
        icon: AdminPanelSettings
        permissions: ["Manage users", "System admin"]
        subitems:
          - name: DB Stats
            icon: Assessment
            permissions: ["System admin"]
            url: /db_stats
          - name: User Management
            icon: Group
            permissions: ["Manage users", "System admin"]
            url: /user_management

    security:
      strict: true
      slack:
        enabled: false
        url: null

    homepage_grid:
      # This section describes the grid on which Home Page widgets are laid out.
      #
      # The breakpoints describe screen sizes at which a different set of widget
      # layouts should be used. Note that these breakpoints describe minimum width
      # values, unlike the maximum width bounds used by Material UI breakpoints.
      # For example, a breakpoint of "sm: 650" will match windows with width 650px
      # or greater, until the next highest breakpoint is hit (probably a "md").
      # This is different from Material UI, where a breakpoint of 650 would match
      # window widths that are at most 650px.
      #
      # The cols describe the number of evenly spaced columns that make up the
      # grid at a given breakpoint. For example, on extra-large screens (greater
      # than ${breakpoints.xlg} pixels), the grid will use ${cols.xlg} columns of
      # equal width to describe sizes of widgets based on the layouts provided.
      #
      # Optionally, you may provide a "row_height: {a rem value}" property in
      # this section to change the height of a row on the grid. By default, this
      # value is 9.375rem (150px for the default 16px = 1rem configuration).

      breakpoints:
        xlg: 1400
        lg: 1150
        md: 996
        sm: 650
        xs: 0

      cols:
        xlg: 16
        lg: 12
        md: 10
        sm: 6
        xs: 4

    homepage_widgets:
      # This section describes the specific widgets shown on the Home Page and how
      # they are laid out by default on the grid of the page.
      #
      # The name of section should be the same as the widget's React component.
      #
      # The props property should be a set of properties to be passed on to the
      # underlying React component for the widget. You may run into cases in which
      # you must pass a more complex, dyamic property (perhaps fetched from the
      # application redux store). Since you can not know that in the time of the
      # configuration writing, such properties should be directly coded into the
      # HomePage.jsx.template file (see the GroupList widget for an example)
      #
      # By default, any widget listed here is shown on the Home Page. However, you
      # can give a widget the property "show: false" to turn off rendering of the
      # widget.
      #
      # The resizable property determines whether the user is able to resize the
      # widget after it has been rendered based on default layouts.
      #
      # Finally, the layouts property provides an array of default sizes/locations
      # for each screen width breakpoint for the given widget. Layout arrays are
      # given in the order [x, y, width, height], in units of grid columns/rows.
      # For example, a layout array of [1, 2, 3, 4] will render a widget 3 grid
      # columns in width, 4 grid rows in height, and have its upper-left corner at
      # the column 1 (zero-indexed) and row 2. Note that each row is by default
      # 150px in height. The row height can be altered in the homepage_grid
      # section above (as well as other grid characteristics).
      WeatherWidget:
        resizeable: true
        minW: 2
        layouts:
          xlg: [12, 3, 4, 2]
          lg: [9, 3, 3, 2]
          md: [6, 6, 4, 3]
          sm: [0, 9, 6, 1]
          xs: [0, 19, 5, 1]

      SourceCounts:
        props:
          sinceDaysAgo: 7
        resizeable: true
        minW: 1.5
        layouts:
          xlg: [14, 0, 2, 1]
          lg: [10, 0, 2, 1]
          md: [8, 0, 2, 1]
          sm: [4.5, 0, 1.5, 1]
          xs: [0, 0, 4, 1]

      RecentSources:
        resizeable: true
        minW: 2
        layouts:
          xlg: [0, 0, 5, 3]
          lg: [0, 0, 4, 3]
          md: [0, 0, 4, 3]
          sm: [0, 3, 3, 3]
          xs: [0, 4, 4, 3]

      NewsFeed:
        resizeable: true
        minW: 2
        layouts:
          xlg: [10, 0, 4, 3]
          lg: [7, 0, 3, 3]
          md: [4, 0, 4, 3]
          sm: [0, 0, 4.5, 3]
          xs: [0, 1, 4, 3]

      TopSources:
        resizeable: true
        minW: 2
        layouts:
          xlg: [5, 0, 5, 3]
          lg: [4, 0, 3, 3]
          md: [0, 3, 4, 3]
          sm: [3, 3, 3, 3]
          xs: [0, 7, 4, 3]

      TopSavers:
        resizeable: true
        minW: 3
        layouts:
          xlg: [7, 3, 5, 3]
          lg: [5, 3, 4, 2]
          md: [0, 6, 6, 3]
          sm: [0, 10, 6, 3]
          xs: [0, 14, 4, 3]

      RecentGcnEvents:
        resizeable: true
        minW: 3
        layouts:
          xlg: [0, 3, 7, 3]
          lg: [0, 3, 5, 2]
          md: [4, 3, 6, 3]
          sm: [0, 6, 6, 3]
          xs: [0, 10, 4, 4]

      GroupList:
        props:
          title: My Groups
        resizeable: true
        minW: 1.5
        layouts:
          xlg: [14, 1, 2, 2]
          lg: [10, 1, 2, 2]
          md: [8, 1, 2, 2]
          sm: [4.5, 1, 1.5, 2]
          xs: [0, 17, 4, 2]

  database:
    database: skyportal
    host: db
    port: 5432
    user: skyportal
    password: password

  ports:
    facility_queue: 64510
    notification_queue: 64610
    observation_plan_queue: 64710
    thumbnail_queue: 64910
    tns_retrieval_queue: 64810
    sharing_service_submission_queue: 64812

  server:
    # From https://console.developers.google.com/
    #
    # - Create Client ID
    # - Javascript origins: https://localhost:5000
    # - Authorized redirect URLs: http://localhost:5000/complete/google-oauth2/
    #
    # You need to have Google+ API enabled; it takes a few minutes to activate.

    protocol: http
    host: <host>
    port:

    # It is recommended to use TLS in production
    ssl: False
    processes: 4

    # The max size of a request body in megabytes (M)
    max_body_size: 100

    # nginx parameter which sets both the time in seconds before which
    # the server is considered unavailable and the subsequent period of
    # time the server will be unavailable
    fail_timeout: 60

    # Rate limit: number of requests per second (see https://www.nginx.com/blog/rate-limiting-nginx/)
    rate_limit: 5
    # Rate limit burst size (https://www.nginx.com/blog/rate-limiting-nginx/#bursts)
    burst: 10

    # In addition to the local network, specify any IP addresses that are to be
    # exempt from API rate limiting
    whitelisted_ips:
      # Class A private network
      - 10.0.0.0/8
      # Class B private network
      - 172.16.0.0/12
      # Class C private network
      - 192.168.0.0/16
      # skipper.caltech.edu
      - 131.215.198.228
      # kowalski.caltech.edu
      - 131.215.198.229

    # Specify IPs or address ranges (e.g., 130.211.0.0/22) that are associated
    # with upstream load balancing.
    # These trusted addresses are used to uncover the originating IP.
    loadbalancer_ips:
      # Google Load Balancer IPs
      # See https://cloud.google.com/load-balancing/docs/https#x-forwarded-for_header
      - 130.211.0.0/22
      - 35.191.0.0/16
      # preview.fritz.science
      - 34.120.0.80
      # fritz.science
      - 35.244.192.22

    auth:
      debug_login: True
      google_oauth2_key:
      google_oauth2_secret:
      google_oauth2_timeout: 15

  services:
    dask: False

  misc:
    days_to_keep_unsaved_candidates: 7
    minutes_to_keep_candidate_query_cache: 120
    minutes_to_keep_source_query_cache: 360
    minutes_to_keep_localization_instrument_query_cache: 1440
    max_items_in_localization_instrument_query_cache: 100
    minutes_to_keep_public_source_pages_cache: 1440
    minutes_to_keep_reports_cache: 1440
    public_group_name: "Sitewide Group"
    # Use a named cosmology from `astropy.cosmology.parameters.available` cosmologies
    # or supply the arguments for an `astropy.cosmology.FLRW` cosmological instance.
    # If {"flat": True} then use a subclass of the FLRW, called `FlatLambdaCMD`
    # otherwise use `LambdaCDM`. See `utils.cosmology.py` for the way in which
    # the user-supplied cosmology parameter set constructs the site-wide cosmology.
    cosmology: Planck18
    #cosmology: {H0: "65.0", Om0: 0.3, Ode0: 0.7, name: 'skyportal_user_cosmo'}

    dustmap: sfd
    dustmap_folder: persistentdata/dustmap

    # The minimum signal-to-noise ratio/ n-sigma for lim mag cacluations to
    # consider a photometry point as a detection
    photometry_detection_threshold_nsigma: 3.0

    # The airmass value below which to track hours for when plotting
    # on an object's observability page
    hours_below_airmass_threshold: 2.9

    color_palette: turbo

  external_logging:
    papertrail:
      # get an account at https://papertrailapp.com
      enabled: False
      # change url to the correct subdomain for your account
      # and change the port as well
      url:
      port:
      # which log files, if any do you not want to send over to the 3rd party?
      excluded_log_files: ["log/websocket_server.log"]

    sentry:
      endpoint:
      # Set traces_sample_rate to 1.0 to capture 100%
      # of transactions for performance monitoring.
      # Sentry recommends adjusting this value in production.
      traces_sample_rate: 1.0
      # Set profiles_sample_rate to 1.0 to profile 100%
      # of sampled transactions.
      # We recommend adjusting this value in production.
      profiles_sample_rate: 1.0

  weather:
    refresh_time: 3600.0
    openweather_api_key:

  cron: []
#    - interval: 60
#      script: jobs/count_unsaved_candidates.py
    # - interval: 1440
    #   script: jobs/delete_unsaved_candidates.py
    #   limit: ["01:00", "02:00"]

  comments_folder: persistentdata/comments

  analysis_services:
    analysis_folder: persistentdata/analysis
    max_analysis_per_obj_per_user: 50
    sn_analysis_service:
      port: 6801
    ngsf_analysis_service:
      port: 7001
    spectral_cube_analysis_service:
      port: 7002
    openai_analysis_service:
      port: 7003
      summary:
        # set this global API key if the project
        # will pay for the OpenAI costs. Otherwise
        # individual users need to set their own key
        # in the user preferences
        # Get a global key at:
        #   https://platform.openai.com/account/api-keys
        api_key:
        temperature: 0.2
        max_tokens: 350
        top_p: 1.0
        frequency_penalty: 0.0
        model: gpt-3.5-turbo
        presence_penalty: 1.0
        prompt: Using markdown (with appropriate URL links), in one human-readable paragraph please summarize the following comments about this astronomical source. If classification and/or redshift are given, then note those in the summary. This summary will be primarily read by professional astronomers to help them with their work.
      embeddings_store:
        summary:
          location: pinecone
          environment: us-east1-gcp
          api_key:
          index_name: openai-skyportal-summary
          index_size: 1536
          model: text-embedding-ada-002
          pod_type: p1.x1

  gcn:
    server: gcn.nasa.gov
    # you can obtain a client_id and client_secret at https://gcn.nasa.gov/quickstart
    # you can set a group_id to remember the last GCN the app ingested from the stream
    client_group_id:
    client_id:
    client_secret:
    notice_types:
      voevent:
        - gcn.classic.voevent.FERMI_GBM_FLT_POS
        - gcn.classic.voevent.FERMI_GBM_GND_POS
        - gcn.classic.voevent.FERMI_GBM_FIN_POS
        - gcn.classic.voevent.FERMI_GBM_SUBTHRESH
        - gcn.classic.voevent.SWIFT_BAT_GRB_POS_ACK
        - gcn.classic.voevent.SWIFT_XRT_POSITION
        - gcn.classic.voevent.LVC_PRELIMINARY
        - gcn.classic.voevent.LVC_INITIAL
        - gcn.classic.voevent.LVC_UPDATE
        - gcn.classic.voevent.LVC_RETRACTION
        # - gcn.classic.voevent.AMON_ICECUBE_COINC
        # - gcn.classic.voevent.AMON_ICECUBE_HESE
        - gcn.classic.voevent.ICECUBE_ASTROTRACK_GOLD
        - gcn.classic.voevent.ICECUBE_ASTROTRACK_BRONZE
        - gcn.classic.voevent.MAXI_UNKNOWN
        - gcn.notices.svom.voevent.grm
        - gcn.notices.svom.voevent.eclairs
      json:
        - einstein_probe.wxt.alert
        - swift.bat.guano
        - icecube.lvk_nu_track_search
    reject_tags: # reject notices with these tags (optional)
      - MDC
      - ECLAIRs-Catalog


  twilio:
    # Twilio Sendgrid API configs
    # This needs to be set to a valid, Sendgrid-registered address in config.yaml
    from_email:
    # This needs to be obtained via Sendgrid setup on their site
    sendgrid_api_key:

    # Twilio SMS API configs
    # These values must be valid ones from the Twilio API console
    from_number:
    sms_account_sid:
    sms_auth_token:

  smtp:
    from_email:
    password:
    host:
    port:

  # This value needs to be either "sendgrid" or "smtp" (without quotes)
  email_service: sendgrid

  invitations:
    enabled: False # If debug_login=True above, invite tokens won't be used during auth
    days_until_expiry: 3
    email_subject: "You have been invited to collaborate on Fritz"
    email_body_preamble: | # This can include HTML tags
      Welcome to <b>Fritz</b>!
      <br />
      Dark star crashes, pouring its light into ashes.

  notifications:
    enabled: True

  standard_stars:
    ZTF: data/ztf_standards.csv
    ESO: data/eso_standards.csv

  # Parameters for the thumbnail classification function which labels
  # images as grayscale or colored. See utils/thumbnail.py for the function.
  image_grayscale_params:
    thumb_size: 40
    MSE_cutoff: 22
    adjust_color_bias: True

  slack:
    microservice_port: 64100
    expected_url_preamble: "https://hooks.slack.com/"

  spectrum_types:
    types:
      - source
      - host
      - host_center
    default: source

  # define the additional passbands that are not in SNCosmo
  # (https://sncosmo.readthedocs.io/en/stable/bandpass-list.html)
  # the names must be unique. The wavelength array should
  # describe the full extent of the bandpass in Angstrom
  # and the transmission should be a vector of the same
  # length that defines the full Quantum Efficiency at each wavelength.
  # must have at least two elements in the arrays
  # `wavelength` and `transmission`.
  # additional_bandpasses:
  #  - name: 'atlasc'
  #    filterset: 'atlas'
  #    wavelength: [4150, 4157, 6556, 6560]
  #    transmission: [0, 1, 1, 0]
  #    description: "basic ATLAS C filter - tophat transmission"
  #  - name: 'atlaso'
  #    filterset: 'atlas'
  #    wavelength: [5580, 5582, 8249, 8250]
  #    transmission: [0, 1, 1, 0]
  #    description: "basic ATLAS O filter - tophat transmission"

  docs:
    servers:
      - url: https://fritz.science
        description: Production
      - url: https://preview.fritz.science
        description: Preview/Testing

kowalski:
  server:
    name: "Kowalski"
    version: "3.0.0"
    description: "Kowalski: a toolkit for Time-Domain Astronomy, provides an API to access most of its underlying functionality.
      To use it, you will need a user account that can be provided by the system's administrator. Once you have an account you can retrieve your token using the `/api/auth` endpoint described here.
      We strongly suggest accessing Kowalski using its dedicated Python client: [penquins](https://github.com/dmitryduev/penquins). It comes with its own documentation and examples, and can be installed with `pip install penquins`.
      If you have any questions or need help, please contact us."
    host: "0.0.0.0"
    port: 4000
    processes: 4
    max_requests: 100000
    timeout: 36000
    admin_username: "admin"
    # fixme: use ''.join(secrets.choice(string.ascii_lowercase + string.digits) for _ in range(32))
    admin_password: "admin"
    # fixme: use ''.join(secrets.choice(string.ascii_lowercase + string.digits) for _ in range(32))
    SECRET_KEY: "abc0123"
    JWT_SECRET_KEY: "abc0123"
    JWT_ALGORITHM: "HS256"
    JWT_EXP_DELTA_SECONDS:
    # fixme: use from cryptography.fernet import Fernet; Fernet.generate_key().decode()
    fernet_key: "irjsxvfJdqSJ2fcnpPacbH972dt-RPMMLE48PQ8J5Hg="
    client_max_size: 1048576
    contact:
      name: "Your Name"
      email: "your_email@your_domain.com"

  ztf:
    mountain_ip: null
    mountain_port: null
    mountain_username: null
    mountain_password: null
    mountain_bind_ip: null
    mountain_bind_port: null

  kafka:
    default.topic.config:
      auto.offset.reset: "earliest"
    group: "kowalski"
    scala_version: "2.13"
    kafka_version: "3.4.1"
    bootstrap.servers: "192.168.0.64:9092,192.168.0.65:9092,192.168.0.66:9092"
    zookeeper: "192.168.0.64:2181"
    bootstrap.test.servers: "localhost:9092"
    zookeeper.test: "localhost:2181"
    path: "kafka_2.13-3.4.1"
    processes_per_topic:
      ZTF: 1

  database:
    max_pool_size: 200
    max_wired_tiger_cache:
    host: "kowalski_mongo_1"
    port: 27017
    # if not null, must be same as in entrypoint of mongo container
    replica_set: "rs0"
    db: "kowalski"
    admin_username: "mongoadmin"
    # fixme: use strong password if exposing the database to the world
    admin_password: "mongoadminsecret"
    username: "ztf"
    # fixme: use strong password if exposing the database to the world
    password: "ztf"
    srv: False # to use with mongodb atlas or any other distant mongodb server, where specifying a port is not necessary
    build_indexes: True

    collections:
      users: "users"
      filters: "filters"
      queries: "queries"
      alerts_ztf: "ZTF_alerts"
      alerts_ztf_aux: "ZTF_alerts_aux"
      alerts_ztf_classifications: "ZTF_alerts_classifications"
      alerts_pgir: "PGIR_alerts"
      alerts_pgir_aux: "PGIR_alerts_aux"
      alerts_wntr: "WNTR_alerts"
      alerts_wntr_aux: "WNTR_alerts_aux"
      alerts_turbo: "TURBO_alerts"
      alerts_turbo_aux: "TURBO_alerts_aux"
      skymaps: "skymaps"
      tns: "TNS"

    indexes:
      ZTF_alerts:
        - name: radec_candid
          fields:
            - ["coordinates.radec_geojson", "2dsphere"]
            - ["candid", -1]
          unique: false
        - name: radec_objectId
          fields:
            - ["coordinates.radec_geojson", "2dsphere"]
            - ["objectId", -1]
          unique: false
        - name: jd_radec_candid
          fields:
            - ["candidate.jd", 1]
            - ["coordinates.radec_geojson", "2dsphere"]
            - ["candid", -1]
          unique: false
        - name: jd_radec_objectId
          fields:
            - ["candidate.jd", 1]
            - ["coordinates.radec_geojson", "2dsphere"]
            - ["objectId", -1]
          unique: false
        - name: objectId
          fields:
            - ["objectId", -1]
          unique: false
        - name: candid
          fields:
            - ["candid", -1]
          unique: true
        - name: pid
          fields:
            - ["candidate.pid", 1]
          unique: false
        - name: objectId_pid
          fields:
            - ["objectId", -1]
            - ["candidate.pid", 1]
          unique: false
        - name: pdiffimfilename
          fields:
            - ["candidate.pdiffimfilename", 1]
          unique: false
        - name: jd_programid_programpi
          fields:
            - ["candidate.jd", 1]
            - ["candidate.programid", 1]
            - ["candidate.programpi", 1]
          unique: false
        - name: jd_braai_candid
          fields:
            - ["candidate.jd", -1]
            - ["classifications.braai", -1]
            - ["candid", -1]
          unique: false
        - name: jd_drb_candid
          fields:
            - ["candidate.jd", -1]
            - ["candidate.drb", -1]
            - ["candid", -1]
          unique: false
        - name: jd_braai_magpsf_isdiffpos_ndethist
          fields:
            - ["candidate.jd", 1]
            - ["classifications.braai", 1]
            - ["candidate.magpsf", 1]
            - ["candidate.isdiffpos", 1]
            - ["candidate.ndethist", 1]
          unique: false
        - name: jd_field_drb_ndethhist_magpsf_isdiffpos_objectId
          fields:
            - ["candidate.jd", 1]
            - ["candidate.field", 1]
            - ["candidate.rb", 1]
            - ["candidate.drb", 1]
            - ["candidate.ndethist", 1]
            - ["candidate.magpsf", 1]
            - ["candidate.isdiffpos", 1]
            - ["objectId", -1]
          unique: false

      TNS:
        - name: radec__id
          fields:
            - ["coordinates.radec_geojson", "2dsphere"]
            - ["_id", -1]
          unique: false
        - name: discovery_date
          fields:
            - ["discovery_date", -1]
          unique: false

      PGIR_alerts:
        - name: radec_candid
          fields:
            - [ "coordinates.radec_geojson", "2dsphere" ]
            - [ "candid", -1 ]
          unique: false
        - name: radec_objectId
          fields:
            - [ "coordinates.radec_geojson", "2dsphere" ]
            - [ "objectId", -1 ]
          unique: false
        - name: jd_radec_candid
          fields:
            - [ "candidate.jd", 1 ]
            - [ "coordinates.radec_geojson", "2dsphere" ]
            - [ "candid", -1 ]
          unique: false
        - name: jd_radec_objectId
          fields:
            - [ "candidate.jd", 1 ]
            - [ "coordinates.radec_geojson", "2dsphere" ]
            - [ "objectId", -1 ]
          unique: false
        - name: objectId
          fields:
            - [ "objectId", -1 ]
          unique: false
        - name: candid
          fields:
            - [ "candid", -1 ]
          unique: true
        - name: jd_drb_candid
          fields:
            - [ "candidate.jd", -1 ]
            - [ "candidate.drb", -1 ]
            - [ "candid", -1 ]
          unique: false
        - name: jd_drb_ndethist_dmag2mass_isstar_distnearbrstar
          fields:
            - [ "candidate.jd", -1 ]
            - [ "candidate.drb", -1 ]
            - [ "candidate.ndethist", 1 ]
            - [ "candidate.dmag2mass", -1 ]
            - [ "candidate.isstar", -1 ]
            - [ "candidate.distnearbrstar", 1 ]
          unique: false
        - name: jd_scorr_dmag2mass
          fields:
            - [ "candidate.jd", -1 ]
            - [ "candidate.scorr", -1 ]
            - [ "candidate.dmag2mass", -1 ]
          unique: false

      WNTR_alerts:
        - name: radec_candid
          fields:
            - ["coordinates.radec_geojson", "2dsphere"]
            - ["candid", -1]
          unique: false
        - name: radec_objectid
          fields:
            - ["coordinates.radec_geojson", "2dsphere"]
            - ["objectid", -1]
          unique: false
        - name: jd_radec_candid
          fields:
            - ["candidate.jd", 1]
            - ["coordinates.radec_geojson", "2dsphere"]
            - ["candid", -1]
          unique: false
        - name: jd_radec_objectid
          fields:
            - ["candidate.jd", 1]
            - ["coordinates.radec_geojson", "2dsphere"]
            - ["objectid", -1]
          unique: false
        - name: objectid
          fields:
            - ["objectid", -1]
          unique: false
        - name: candid
          fields:
            - ["candid", -1]
          unique: true

      TURBO_alerts:
        - name: radec_candid
          fields:
            - ["coordinates.radec_geojson", "2dsphere"]
            - ["candid", -1]
          unique: false
        - name: radec_objectId
          fields:
            - ["coordinates.radec_geojson", "2dsphere"]
            - ["objectId", -1]
          unique: false
        - name: jd_radec_candid
          fields:
            - ["candidate.jd", 1]
            - ["coordinates.radec_geojson", "2dsphere"]
            - ["candid", -1]
          unique: false
        - name: jd_radec_objectId
          fields:
            - ["candidate.jd", 1]
            - ["coordinates.radec_geojson", "2dsphere"]
            - ["objectId", -1]
          unique: false
        - name: objectId
          fields:
            - ["objectId", -1]
          unique: false
        - name: candid
          fields:
            - ["candid", -1]
          unique: true
        - name: jd_drb_candid
          fields:
            - ["candidate.jd", -1]
            - ["candidate.drb", -1]
            - ["candid", -1]
          unique: false
        - name: jd_drb_ndethist_dmag2mass_isstar_distnearbrstar
          fields:
            - ["candidate.jd", -1]
            - ["candidate.drb", -1]
            - ["candidate.ndethist", 1]
            - ["candidate.dmag2mass", -1]
            - ["candidate.isstar", -1]
            - ["candidate.distnearbrstar", 1]
          unique: false
        - name: jd_scorr_dmag2mass
          fields:
            - ["candidate.jd", -1]
            - ["candidate.scorr", -1]
            - ["candidate.dmag2mass", -1]
          unique: false

    filters:
      ZTF_alerts:
        # default upstream aggregation pipeline stages for filtering ZTF alerts:
        - {
            "$match":
              { "candid": null, "candidate.programid": { "$in": null } },
          }
        - {
            "$project":
              {
                "cutoutScience": 0,
                "cutoutTemplate": 0,
                "cutoutDifference": 0,
              },
          }
        - {
            "$lookup":
              {
                "from": "ZTF_alerts_aux",
                "localField": "objectId",
                "foreignField": "_id",
                "as": "aux",
              },
          }
        - {
            "$project":
              {
                "cross_matches": { "$arrayElemAt": ["$aux.cross_matches", 0] },
                "prv_candidates":
                  {
                    "$filter":
                      {
                        "input": { "$arrayElemAt": ["$aux.prv_candidates", 0] },
                        "as": "item",
                        "cond":
                          {
                            "$and":
                              [
                                { "$in": ["$$item.programid", null] },
                                {
                                  "$lt":
                                    [
                                      {
                                        "$subtract":
                                          ["$candidate.jd", "$$item.jd"],
                                      },
                                      365,
                                    ],
                                },
                              ],
                          },
                      },
                  },
                "fp_hists":
                  {
                    "$filter":
                      {
                        "input": { "$arrayElemAt": ["$aux.fp_hists", 0] },
                        "as": "item",
                        "cond":
                          {
                            "$and":
                              [
                                { "$in": ["$$item.programid", null] },
                                {
                                  "$lt":
                                    [
                                      {
                                        "$subtract":
                                          ["$candidate.jd", "$$item.jd"],
                                      },
                                      365,
                                    ],
                                },
                                { "$eq": ["$$item.procstatus", "0"] },
                              ],
                          },
                      },
                  },
                "schemavsn": 1,
                "publisher": 1,
                "objectId": 1,
                "candid": 1,
                "candidate": 1,
                "classifications": 1,
                "coordinates": 1,
              },
          }

      PGIR_alerts:
        # default upstream aggregation pipeline stages for filtering PGIR alerts:
        - {
            "$match":
              {
                "candid": null
              },
          }
        - {
            "$project":
              {
                "cutoutScience": 0,
                "cutoutTemplate": 0,
                "cutoutDifference": 0,
              },
          }
        - {
            "$lookup":
              {
                "from": "PGIR_alerts_aux",
                "localField": "objectId",
                "foreignField": "_id",
                "as": "aux",
              },
          }
        - {
            "$project":
              {
                "cross_matches": { "$arrayElemAt": ["$aux.cross_matches", 0] },
                "prv_candidates":
                  {
                    "$filter":
                      {
                        "input": { "$arrayElemAt": ["$aux.prv_candidates", 0] },
                        "as": "item",
                        "cond":
                          {
                            "$lt":
                              [
                                {
                                  "$subtract":
                                    ["$candidate.jd", "$$item.jd"],
                                },
                                1000,
                              ],
                          },
                      },
                  },
                "schemavsn": 1,
                "publisher": 1,
                "objectId": 1,
                "candid": 1,
                "candidate": 1,
                "classifications": 1,
                "coordinates": 1,
              },
          }

      WNTR_alerts:
        # TODO verify! copied from PGIR - 1 Aug 2022
        # default upstream aggregation pipeline stages for filtering WNTR alerts:
        - {
            "$match":
              {
                "candid": null
              },
          }
        - {
            "$project":
              {
                "cutout_science": 0,
                "cutout_template": 0,
                "cutout_difference": 0,
              },
          }
        - {
            "$lookup":
              {
                "from": "WNTR_alerts_aux",
                "localField": "objectid",
                "foreignField": "_id",
                "as": "aux",
              },
          }
        - {
            "$project":
              {
                "cross_matches": { "$arrayElemAt": ["$aux.cross_matches", 0] },
                "prv_candidates":
                  {
                    "$filter":
                      {
                        "input": { "$arrayElemAt": ["$aux.prv_candidates", 0] },
                        "as": "item",
                        "cond":
                          {
                            "$lt":
                              [
                                {
                                  "$subtract":
                                    ["$candidate.jd", "$$item.jd"],
                                },
                                1000,
                              ],
                          },
                      },
                  },
                "schemavsn": 1,
                "publisher": 1,
                "objectid": 1,
                "candid": 1,
                "candidate": 1,
                "classifications": 1,
                "coordinates": 1,
              },
          }

      TURBO_alerts:
        # default upstream aggregation pipeline stages for filtering ZTF alerts (may need to be changed for TURBO):
        - {
            "$match":
              { "candid": null, "candidate.programid": { "$in": null } },
          }
        - {
            "$project":
              {
                "cutoutScience": 0,
                "cutoutTemplate": 0,
                "cutoutDifference": 0,
              },
          }
        - {
            "$lookup":
              {
                "from": "TURBO_alerts_aux",
                "localField": "objectId",
                "foreignField": "_id",
                "as": "aux",
              },
          }
        - {
            "$project":
              {
                "cross_matches": { "$arrayElemAt": ["$aux.cross_matches", 0] },
                "prv_candidates":
                  {
                    "$filter":
                      {
                        "input": { "$arrayElemAt": ["$aux.prv_candidates", 0] },
                        "as": "item",
                        "cond":
                          {
                            "$and":
                              [
                                { "$in": ["$$item.programid", null] },
                                {
                                  "$lt":
                                    [
                                      {
                                        "$subtract":
                                          ["$candidate.jd", "$$item.jd"],
                                      },
                                      365,
                                    ],
                                },
                              ],
                          },
                      },
                  },
                "schemavsn": 1,
                "publisher": 1,
                "objectId": 1,
                "candid": 1,
                "candidate": 1,
                "classifications": 1,
                "coordinates": 1,
              },
          }

    xmatch:
      ZTF:
        2MASS_PSC:
          cone_search_radius: 2
          cone_search_unit: "arcsec"
          filter: { }
          projection:
            _id: 1
            coordinates.radec_str: 1
            j_m: 1
            h_m: 1
            k_m: 1

        AllWISE:
          cone_search_radius: 2
          cone_search_unit: "arcsec"
          filter: { }
          projection:
            _id: 1
            coordinates.radec_str: 1
            w1mpro: 1
            w1sigmpro: 1
            w2mpro: 1
            w2sigmpro: 1
            w3mpro: 1
            w3sigmpro: 1
            w4mpro: 1
            w4sigmpro: 1
            ph_qual: 1

        Gaia_DR2:
          cone_search_radius: 2
          cone_search_unit: "arcsec"
          filter: { }
          projection:
            _id: 1
            coordinates.radec_str: 1
            parallax: 1
            parallax_error: 1
            phot_g_mean_mag: 1
            phot_bp_mean_mag: 1
            phot_rp_mean_mag: 1

        Gaia_EDR3:
          cone_search_radius: 2
          cone_search_unit: "arcsec"
          filter: { }
          projection:
            _id: 1
            coordinates.radec_str: 1
            parallax: 1
            parallax_error: 1
            phot_g_mean_mag: 1
            phot_bp_mean_mag: 1
            phot_rp_mean_mag: 1

        Gaia_DR2_WD:
          cone_search_radius: 2
          cone_search_unit: "arcsec"
          filter: { }
          projection:
            _id: 1
            coordinates.radec_str: 1
            White_dwarf_name: 1
            Pwd: 1
            Pwd_correction: 1
            SDSS_name: 1
            Teff: 1
            eTeff: 1

        PS1_STRM:
          cone_search_radius: 2
          cone_search_unit: "arcsec"
          filter: { }
          projection:
            _id: 1
            objID: 1
            coordinates.radec_str: 1
            class: 1
            prob_Galaxy: 1
            prob_Star: 1
            prob_QSO: 1
            z_phot: 1
            z_phot_err: 1

        galaxy_redshifts_20200522:
          cone_search_radius: 2
          cone_search_unit: "arcsec"
          filter: { }
          projection:
            _id: 1
            coordinates.radec_str: 1
            z: 1
            l: 1
            b: 1

        GALEX:
          cone_search_radius: 2
          cone_search_unit: "arcsec"
          filter: { }
          projection:
            _id: 0
            name: 1
            coordinates.radec_str: 1
            FUVmag: 1
            e_FUVmag: 1
            NUVmag: 1
            e_NUVmag: 1

        IGAPS_DR2:
          cone_search_radius: 2
          cone_search_unit: "arcsec"
          filter: { }
          projection:
            _id: 0
            name: 1
            coordinates.radec_str: 1
            r: 1
            rErr: 1
            i: 1
            iErr: 1
            ha: 1
            haErr: 1
            U_RGO: 1
            UErr: 1

        LAMOST_DR5_v3:
          cone_search_radius: 2
          cone_search_unit: "arcsec"
          filter: { }
          projection:
            _id: 1
            coordinates.radec_str: 1
            mjd: 1
            snru: 1
            snrg: 1
            snrr: 1
            snri: 1
            snrz: 1
            objtype: 1
            class: 1
            subclass: 1

        PS1_DR1:
          cone_search_radius: 2
          cone_search_unit: "arcsec"
          filter: { }
          projection:
            _id: 1
            coordinates.radec_str: 1
            gMeanPSFMag: 1
            gMeanPSFMagErr: 1
            rMeanPSFMag: 1
            rMeanPSFMagErr: 1
            iMeanPSFMag: 1
            iMeanPSFMagErr: 1
            zMeanPSFMag: 1
            zMeanPSFMagErr: 1
            yMeanPSFMag: 1
            yMeanPSFMagErr: 1

        CLU_20190625:
          cone_search_radius: 3
          cone_search_unit: "deg"
          use_distance: True
          distance_value: "z"
          distance_method: "redshift"
          cm_at_distance: 30 # in kpc
          cm_low_distance: 300 # arcsec
          filter: {}
          projection:
            _id: 1
            name: 1
            ra: 1
            dec: 1
            a: 1
            b2a: 1
            pa: 1
            z: 1
            sfr_fuv: 1
            mstar: 1
            sfr_ha: 1
            coordinates.radec_str: 1

        NED_BetaV3:
          cone_search_radius: 3
          cone_search_unit: "deg"
          use_distance: True
          distance_value: "DistMpc"
          distance_method: "mpc"
          cm_at_distance: 30 # in kpc
          cm_low_distance: 300 # arcsec
          filter: {}
          projection:
            _id: 1
            coordinates.radec_str: 1
            ra: 1
            dec: 1
            objname: 1
            objtype: 1
            z: 1
            z_unc: 1
            z_tech: 1
            z_qual: 1
            DistMpc: 1
            DistMpc_unc: 1
            ebv: 1
            m_Ks: 1
            m_Ks_unc: 1
            tMASSphot: 1
            Mstar: 1
            Mstar_unc: 1

        milliquas:
          cone_search_radius: 2
          cone_search_unit: "arcsec"
          filter: {}
          projection:
            _id: 1
            coordinates.radec_str: 1
            Name: 1
            Descrip: 1
            Qpct: 1

      PGIR:
        2MASS_PSC:
          cone_search_radius: 8
          cone_search_unit: "arcsec"
          filter: { }
          projection:
            _id: 1
            coordinates.radec_str: 1
            j_m: 1
            h_m: 1
            k_m: 1

        AllWISE:
          cone_search_radius: 8
          cone_search_unit: "arcsec"
          filter: { }
          projection:
            _id: 1
            coordinates.radec_str: 1
            w1mpro: 1
            w1sigmpro: 1
            w2mpro: 1
            w2sigmpro: 1
            w3mpro: 1
            w3sigmpro: 1
            w4mpro: 1
            w4sigmpro: 1
            ph_qual: 1

        Gaia_DR2:
          cone_search_radius: 8
          cone_search_unit: "arcsec"
          filter: { }
          projection:
            _id: 1
            coordinates.radec_str: 1
            parallax: 1
            parallax_error: 1
            phot_g_mean_mag: 1
            phot_bp_mean_mag: 1
            phot_rp_mean_mag: 1

        Gaia_EDR3:
          cone_search_radius: 8
          cone_search_unit: "arcsec"
          filter: { }
          projection:
            _id: 1
            coordinates.radec_str: 1
            parallax: 1
            parallax_error: 1
            phot_g_mean_mag: 1
            phot_bp_mean_mag: 1
            phot_rp_mean_mag: 1

        PS1_STRM:
          cone_search_radius: 8
          cone_search_unit: "arcsec"
          filter: { }
          projection:
            _id: 1
            objID: 1
            coordinates.radec_str: 1
            class: 1
            prob_Galaxy: 1
            prob_Star: 1
            prob_QSO: 1
            z_phot: 1
            z_phot_err: 1

        galaxy_redshifts_20200522:
          cone_search_radius: 8
          cone_search_unit: "arcsec"
          filter: { }
          projection:
            _id: 1
            coordinates.radec_str: 1
            z: 1
            l: 1
            b: 1

        GALEX:
          cone_search_radius: 8
          cone_search_unit: "arcsec"
          filter: { }
          projection:
            _id: 0
            name: 1
            coordinates.radec_str: 1
            FUVmag: 1
            e_FUVmag: 1
            NUVmag: 1
            e_NUVmag: 1

        IGAPS_DR2:
          cone_search_radius: 8
          cone_search_unit: "arcsec"
          filter: { }
          projection:
            _id: 0
            name: 1
            coordinates.radec_str: 1
            r: 1
            rErr: 1
            i: 1
            iErr: 1
            ha: 1
            haErr: 1
            U_RGO: 1
            UErr: 1

        LAMOST_DR5_v3:
          cone_search_radius: 8
          cone_search_unit: "arcsec"
          filter: { }
          projection:
            _id: 1
            coordinates.radec_str: 1
            mjd: 1
            snru: 1
            snrg: 1
            snrr: 1
            snri: 1
            snrz: 1
            objtype: 1
            class: 1
            subclass: 1

        PS1_DR1:
          cone_search_radius: 8
          cone_search_unit: "arcsec"
          filter: { }
          projection:
            _id: 1
            coordinates.radec_str: 1
            gMeanPSFMag: 1
            gMeanPSFMagErr: 1
            rMeanPSFMag: 1
            rMeanPSFMagErr: 1
            iMeanPSFMag: 1
            iMeanPSFMagErr: 1
            zMeanPSFMag: 1
            zMeanPSFMagErr: 1
            yMeanPSFMag: 1
            yMeanPSFMagErr: 1

        CLU_20190625:
          cone_search_radius: 3
          cone_search_unit: "deg"
          use_distance: True
          distance_value: "z"
          distance_method: "redshift"
          cm_at_distance: 30 # in kpc
          cm_low_distance: 300 # arcsec
          filter: {}
          projection:
            _id: 1
            name: 1
            ra: 1
            dec: 1
            a: 1
            b2a: 1
            pa: 1
            z: 1
            sfr_fuv: 1
            mstar: 1
            sfr_ha: 1
            coordinates.radec_str: 1

      WNTR:
        2MASS_PSC:
          cone_search_radius: 2
          cone_search_unit: "arcsec"
          filter: {}
          projection:
            _id: 1
            coordinates.radec_str: 1
            j_m: 1
            h_m: 1
            k_m: 1

        AllWISE:
          cone_search_radius: 2
          cone_search_unit: "arcsec"
          filter: {}
          projection:
            _id: 1
            coordinates.radec_str: 1
            w1mpro: 1
            w1sigmpro: 1
            w2mpro: 1
            w2sigmpro: 1
            w3mpro: 1
            w3sigmpro: 1
            w4mpro: 1
            w4sigmpro: 1
            ph_qual: 1

        Gaia_EDR3:
          cone_search_radius: 2
          cone_search_unit: "arcsec"
          filter: {}
          projection:
            _id: 1
            coordinates.radec_str: 1
            parallax: 1
            parallax_error: 1
            phot_g_mean_mag: 1
            phot_bp_mean_mag: 1
            phot_rp_mean_mag: 1

        PS1_STRM:
          cone_search_radius: 2
          cone_search_unit: "arcsec"
          filter: {}
          projection:
            _id: 1
            objID: 1
            coordinates.radec_str: 1
            class: 1
            prob_Galaxy: 1
            prob_Star: 1
            prob_QSO: 1
            z_phot: 1
            z_phot_err: 1

        galaxy_redshifts_20200522:
          cone_search_radius: 2
          cone_search_unit: "arcsec"
          filter: {}
          projection:
            _id: 1
            coordinates.radec_str: 1
            z: 1
            l: 1
            b: 1

        GALEX:
          cone_search_radius: 2
          cone_search_unit: "arcsec"
          filter: {}
          projection:
            _id: 0
            name: 1
            coordinates.radec_str: 1
            FUVmag: 1
            e_FUVmag: 1
            NUVmag: 1
            e_NUVmag: 1

        IGAPS_DR2:
          cone_search_radius: 2
          cone_search_unit: "arcsec"
          filter: {}
          projection:
            _id: 0
            name: 1
            coordinates.radec_str: 1
            r: 1
            rErr: 1
            i: 1
            iErr: 1
            ha: 1
            haErr: 1
            U_RGO: 1
            UErr: 1

        LAMOST_DR5_v3:
          cone_search_radius: 2
          cone_search_unit: "arcsec"
          filter: {}
          projection:
            _id: 1
            coordinates.radec_str: 1
            mjd: 1
            snru: 1
            snrg: 1
            snrr: 1
            snri: 1
            snrz: 1
            objtype: 1
            class: 1
            subclass: 1

        PS1_DR1:
          cone_search_radius: 2
          cone_search_unit: "arcsec"
          filter: {}
          projection:
            _id: 1
            coordinates.radec_str: 1
            gMeanPSFMag: 1
            gMeanPSFMagErr: 1
            rMeanPSFMag: 1
            rMeanPSFMagErr: 1
            iMeanPSFMag: 1
            iMeanPSFMagErr: 1
            zMeanPSFMag: 1
            zMeanPSFMagErr: 1
            yMeanPSFMag: 1
            yMeanPSFMagErr: 1

        CLU_20190625:
          cone_search_radius: 3
          cone_search_unit: "deg"
          use_distance: True
          distance_value: "z"
          distance_method: "redshift"
          cm_at_distance: 30 # in kpc
          cm_low_distance: 5 # arcsec
          filter: {}
          projection:
            _id: 1
            name: 1
            ra: 1
            dec: 1
            a: 1
            b2a: 1
            pa: 1
            z: 1
            sfr_fuv: 1
            mstar: 1
            sfr_ha: 1
            coordinates.radec_str: 1

  ml:
    ZTF:
      # instruments need to have a list of allowed features (as tuple), and a list of models
      allowed_features: ('drb', 'diffmaglim', 'ra', 'dec', 'magpsf', 'sigmapsf', 'chipsf', 'fwhm', 'sky', 'chinr', 'sharpnr', 'sgscore1', 'distpsnr1', 'sgscore2', 'distpsnr2', 'sgscore3', 'distpsnr3', 'ndethist', 'ncovhist', 'scorr', 'nmtchps', 'clrcoeff', 'clrcounc', 'neargaia', 'neargaiabright', 'classtar', 'peakmag_so_far', 'maxmag_so_far', 'days_since_peak', 'days_to_peak', 'nnondet', 'age')
      models:
      # models need: a version (string, e.g. "v1"), a triplet (bool), and feature_names (bool, or list of feature names as tuple)
      # if feature_names is True, all features from allowed_features are used
        braai:
          triplet: True
          feature_names: False
          version: "d6_m9"
          url: "https://github.com/dmitryduev/braai/raw/master/models/braai_d6_m9.h5"
        acai_h:
          triplet: True
          feature_names: ('drb', 'diffmaglim', 'ra', 'dec', 'magpsf', 'sigmapsf', 'chipsf', 'fwhm', 'sky', 'chinr', 'sharpnr', 'sgscore1', 'distpsnr1', 'sgscore2', 'distpsnr2', 'sgscore3', 'distpsnr3', 'ndethist', 'ncovhist', 'scorr', 'nmtchps', 'clrcoeff', 'clrcounc', 'neargaia', 'neargaiabright')
          version: "d1_dnn_20201130"
          url: "https://github.com/dmitryduev/acai/raw/master/models/acai_h.d1_dnn_20201130.h5"
        acai_v:
          triplet: True
          feature_names: ('drb', 'diffmaglim', 'ra', 'dec', 'magpsf', 'sigmapsf', 'chipsf', 'fwhm', 'sky', 'chinr', 'sharpnr', 'sgscore1', 'distpsnr1', 'sgscore2', 'distpsnr2', 'sgscore3', 'distpsnr3', 'ndethist', 'ncovhist', 'scorr', 'nmtchps', 'clrcoeff', 'clrcounc', 'neargaia', 'neargaiabright')
          version: "d1_dnn_20201130"
          url: "https://github.com/dmitryduev/acai/raw/master/models/acai_v.d1_dnn_20201130.h5"
        acai_o:
          triplet: True
          feature_names: ('drb', 'diffmaglim', 'ra', 'dec', 'magpsf', 'sigmapsf', 'chipsf', 'fwhm', 'sky', 'chinr', 'sharpnr', 'sgscore1', 'distpsnr1', 'sgscore2', 'distpsnr2', 'sgscore3', 'distpsnr3', 'ndethist', 'ncovhist', 'scorr', 'nmtchps', 'clrcoeff', 'clrcounc', 'neargaia', 'neargaiabright')
          version: "d1_dnn_20201130"
          url: "https://github.com/dmitryduev/acai/raw/master/models/acai_o.d1_dnn_20201130.h5"
        acai_n:
          triplet: True
          feature_names: ('drb', 'diffmaglim', 'ra', 'dec', 'magpsf', 'sigmapsf', 'chipsf', 'fwhm', 'sky', 'chinr', 'sharpnr', 'sgscore1', 'distpsnr1', 'sgscore2', 'distpsnr2', 'sgscore3', 'distpsnr3', 'ndethist', 'ncovhist', 'scorr', 'nmtchps', 'clrcoeff', 'clrcounc', 'neargaia', 'neargaiabright')
          version: "d1_dnn_20201130"
          url: "https://github.com/dmitryduev/acai/raw/master/models/acai_n.d1_dnn_20201130.h5"
        acai_b:
          triplet: True
          feature_names: ('drb', 'diffmaglim', 'ra', 'dec', 'magpsf', 'sigmapsf', 'chipsf', 'fwhm', 'sky', 'chinr', 'sharpnr', 'sgscore1', 'distpsnr1', 'sgscore2', 'distpsnr2', 'sgscore3', 'distpsnr3', 'ndethist', 'ncovhist', 'scorr', 'nmtchps', 'clrcoeff', 'clrcounc', 'neargaia', 'neargaiabright')
          version: "d1_dnn_20201130"
          url: "https://github.com/dmitryduev/acai/raw/master/models/acai_b.d1_dnn_20201130.h5"
        bts:
          triplet: True
          feature_names: ('sgscore1', 'distpsnr1', 'sgscore2', 'distpsnr2', 'fwhm', 'magpsf', 'sigmapsf', 'chipsf', 'ra', 'dec', 'diffmaglim', 'ndethist', 'nmtchps', 'age', 'days_since_peak', 'days_to_peak', 'peakmag_so_far', 'drb', 'ncovhist', 'nnondet', 'chinr', 'sharpnr', 'scorr', 'sky', 'maxmag_so_far')
          version: "v1.0.1"
          format: "pb"
          order: ["triplet", "features"]
          url: "https://raw.githubusercontent.com/nabeelre/BTSbot/main/production_models/v1.0.1.tar.gz"

  skyportal:
    protocol: "http"
    host: skyportal-web-1
    port: 5000
    username: kowalski
    token: <token>

  ztf_depot:
    # fixme:
    username: "username"
    password: "password"

  ztf_ops:
    # fixme: Tom Barlow's ops db
    url: "http://site/allexp.tbl"
    username: "username"
    password: "password"

  tns:
    url: https://wis-tns.org
    bot_id: 31415926
    bot_name: Null
    api_key:

  dask:
    host: 127.0.0.1
    scheduler_port: 8786
    dashboard_address: :8787
    n_workers: 4
    threads_per_worker: 1
    lifetime: 24 hours
    lifetime_stagger: 1 hours
    lifetime_restart: true

  dask_pgir:
    host: 127.0.0.1
    scheduler_port: 8788
    dashboard_address: :8789
    n_workers: 4
    threads_per_worker: 1
    lifetime: 24 hours
    lifetime_stagger: 1 hours
    lifetime_restart: true

  dask_wntr:
    host: 127.0.0.1
    scheduler_port: 8784
    dashboard_address: :8785
    n_workers: 4
    threads_per_worker: 1
    lifetime: 24 hours
    lifetime_stagger: 1 hours
    lifetime_restart: true

  dask_turbo:
    host: 127.0.0.1
    scheduler_port: 8790
    dashboard_address: :8791
    n_workers: 4
    threads_per_worker: 1
    lifetime: 24 hours
    lifetime_stagger: 1 hours
    lifetime_restart: true

  misc:
    broker: True
    supported_penquins_versions: ["2.0.0", "2.0.1", "2.0.2", "2.1.0", "2.1.1", "2.2.0", "2.2.1", "2.3.1", "2.3.2", "2.3.3", "2.4.0", "2.4.1"]
    query_expiration_interval: 5
    max_time_ms: 300000
    max_retries: 100
    logging_level: "debug"
    openapi_validate: False

  slack:
    # Used by the performance_reporter.py task to post Slack messages
    slack_bot_token:
    slack_channel_id:

  enabled:
    ztf: True
    pgir: True
    wntr: True
    turbo: True

docs:
  servers:
    - url: https://fritz.science
      description: Production server
    - url: https://preview.fritz.science
      description: Test server
